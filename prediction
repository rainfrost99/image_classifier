device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')

def predict(image_path, model):
    
    #Predict the class (or classes) of an image using a trained deep learning model.
    model.to('cpu')
    image = process_image(image_path)
    image.unsqueeze_(0)
    model.eval()
    
    with torch.no_grad():
        ps = model.forward(image)
        ps = torch.exp(ps)        
        top_p, top_class = ps.topk(1, dim=1)
        
    return top_p, top_class
    
top_p, top_class = predict(test_dir + '/1/image_06743.jpg', model)
print(top_p, top_class)
